# Lua-developer-Forward_Collision_Preventions_System
2022-1 Summer vacation Project  
Enviorment : C++ Visual Studio 2019

summary  
카메라를 이용하여 입력받는 영상에서 전방의 차량을 인지하고 앞차량과의 거리를 실시간으로 계산하여 충돌이 예상될 시 차량에 대해 브레이크를 걸어준다.  
충돌 할 상황이 아닌데, 충돌 오 인식등을 줄이기 위해 다수의 필터링 단계를 구성하고 계산량을 줄여 최적화를 기대할 수 있는 환경을 개발한다.

Goal  


Logic (Korean)

전방 카메라는 실시간으로 프레임을 입력받음(우선 측방 접근 차량에 대해서는 논외로 치고 전방차량만 계산하기 위해 ROI를 자신의 차선을 기준으로 함)  
ROI 선정 후 프레임에서 ROI 전처리(차선 탐지 알고리즘을 이용한 ROI 분석 및 앞 차량을 탐지)  
입력 프레임을 HSV로 변환(브레이크등의 직관적인 처리를 위하여) 및 외부 환경에 의한 밝기 차이를 줄이기 위해 히스토그램 평활화  
모든 프레임에서 평활화시 연산량이 많으므로 초당 30프레임을 처리한다고 가정 시 6프레임 마다 히스토그램 평활화 처리  
들어오는 프레임과 동일한 이미지를 np.zeros함수를 이용하여 생성 np.zeros((width, height, channel))  
차량 브레이크 등은 빨간색이므로 빨간색을 기준으로 스레시홀딩  
스레시홀딩 된 영역에 대해 컨투어를 그려 밝기 기준을 계산함  
HSV의 V채널(명도)를 이용하여 밝기차를 계산하고 만약 밝기값이 강해지면 브레이크를 밟은 것이므로 스레드를 이용하여 차량의 거리를 계산  
차량의 거리는 능동적으로 계산하기 위해 거리 비율을 계산하고 빠르게 늘어날 시 브레이크 제어  
차량의 속도가 30 이상일때 작동을 한다. 그 이하 속도에서는 다른 동작 없이 영상을 입력받는다.  
거리가 멀면 굳이 브레이크를 걸 필요가 없음, 일정 거리에 들어 왔을때 브레이크가 걸리도록 제어  
출력 영상은 원본영상, 스레시홀딩되고 컨투어로 브레이크등에 바운딩박스를 그린 화면, 내가 인식하고 있는 차량 3개에 대해 출력 영상을 출력  

# Release
차선 검출 알고리즘 추가(원본 코드 링크) : https://webnautes.tistory.com/1244  
병렬 처리를 위한 thread 추가
